{% extends 'ctsapp/main.html' %}
{% load static %}
{% block title %}CTS - Administration{% endblock %}
{% block content %}
{% if meldung %}
    <div class="container">
    <div class="text-center">
        <h2>Sie haben den Spot erfolgreich angelegt!</h2>
        <a href="/administration">Zurück zur Verwaltung</a>
    </div>
    </div>
{% else %}
<div class="container">
    <div class="text-center">
      <h1 >Administration</h1>
    </div>
  <p>Auf dieser Seite kannst du Spots, Spieler und Teams verwalten.</p>
  <div class="panel-group" id="accordion">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse1">Spot anlegen</a>
        </h3>
      </div>
      <div id="collapse1" class="panel-collapse collapse in">
        <div class="panel-body">
                <div class="form-group spot-anlegen-code">
        <label>Code: </label>
        <p id="code"></p>
        <button onclick="get_code()" class="btn btn-default">Code generieren</button>
    </div>
    <form method="POST">
        {% csrf_token %}
        <div class="form-group">
            <label>Spotname</label>
            <input class="form-control" name="bezeichnung" required>
        </div>
        <div class="form-group">
            <label>Beschreibung</label>
            <input class="form-control" name="beschreibung" required>
        </div>
        <div class="form-group">
            <label>Schwierigkeitsgrad</label>
            <div class="radio">
                {% for i in schwierigkeiten %}
                <label><input name="schwierigkeit" type="radio" value="{{ i.schwierigkeit_id }}">{{ i.beschreibung }}</label><br>
                {% endfor %}
            </div>
        </div>
        <div class="form-group">
            <label>Längengrad</label>
            <input class="form-control" name="laengengrad" required>
        </div>
        <div class="form-group">
            <label>Breitengrad</label>
            <input class="form-control" name="breitengrad" required>
        </div>
        <div class="form-group">
            <label>Postleitzahl</label>
            <input class="form-control" name="plz" id="plz" onkeyup="get_orte()" required>
        </div>
        <div class="form-group">
            <label>Ort</label>
            <div id="auswahl"></div>
        </div>
        <input type="hidden" name="code" id="sendcode" required>
        <button class="btn btn-default">Speichern</button>
    </form>
</div>
        </div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse2">Spot löschen</a>
        </h3>
      </div>
      <div id="collapse2" class="panel-collapse collapse">
        <div class="panel-body">Lorem ipsum dolor sit amet, consectetur adipisicing elit,
        sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse3">Spieler sperren/löschen</a>
        </h3>
      </div>
      <div id="collapse3" class="panel-collapse collapse">
        <div class="panel-body">Lorem ipsum dolor sit amet, consectetur adipisicing elit,
        sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse4">Team sperren/löschen</a>
        </h3>
      </div>
      <div id="collapse4" class="panel-collapse collapse">
        <div class="panel-body">Lorem ipsum dolor sit amet, consectetur adipisicing elit,
        sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</div>
      </div>
    </div>
  </div>


{% endif %}
{% endblock %}
{% block script%}
<script>
function get_orte() {
var feld = document.getElementById('plz').value;
var link = "/api/get-ort/" + feld;
output = "";

xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        myObj = JSON.parse(this.responseText);
        for (x in myObj) {
            output += '<label><input type="radio" name="ort_id" value="'+ myObj[x].ort_id +'">' + myObj[x].name + '</label><br>';
        }
        document.getElementById('auswahl').innerHTML = output;
    }
}
xmlhttp.open("GET", link , true);
xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xmlhttp.send(); }

function get_code() {

xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        myObj = JSON.parse(this.responseText);
        document.getElementById('code').innerText = myObj.code;
        document.getElementById('sendcode').value = myObj.code;
    }
}
xmlhttp.open("GET", "/api/get-code/" , true);
xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xmlhttp.send(); }
</script>
{% endblock %}